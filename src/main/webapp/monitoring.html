<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>TODO supply a title</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <script src="/camunda/varna/static/js/chart_js/Chart.bundle.min.js"></script>
        <script
            src="https://code.jquery.com/jquery-3.1.1.min.js"
        crossorigin="anonymous"></script>
    </head>
    <body>
        <form>
            <div style="width:100%;">
                <canvas id="myChart"></canvas>
            </div>
        </form>
        <script>
            var update = function () {
                $.getJSON("/camunda/varna/api/diagram/data", function (data) {
                    var tempMeasured;
                    var tempSet;
                    var power;
                    var time;
                    for (var property in data) {
                        if (data.hasOwnProperty(property)) {
                            if (property === "Naměřená teplota")
                                tempMeasured = data[property];
                            else if (property === "Nastavená teplota")
                                tempSet = data[property];
                            else if (property === "Výkon")
                                power = data[property];
                            else if (property === "Čas")
                                time = data[property];
                        }
                    }

                    data = {
                        labels: time,
                        datasets: [
                            {
                                type: 'line',
                                label: "Naměřená teplota",
                                borderColor: 'rgba(0, 255, 0, 1)',
                                backgroundColor: 'rgba(0, 0, 0, 0)',
                                data: tempMeasured
                            },
//                        {
//                            type: 'line',
//                            label: "Nastavená teplota",
//                            borderColor: 'rgba(0, 0, 255, 1)',
//                            backgroundColor: 'rgba(0, 0, 0, 0)',
//                            data: tempSet
//                        },
                            {
                                type: "line",
                                label: "Výkon",
                                borderColor: 'rgba(255, 0, 0, 1)',
                                backgroundColor: 'rgba(255, 0, 0, 0.3)',
                                data: power,
                            }
                        ]
                    };
                    var ctx = document.getElementById("myChart");
                    var myLineChart = new Chart(ctx, {
                        type: "bar",
                        data: data,
                        options: {
                            scales: {
                                xAxes: [{
                                        type: 'time',
                                        time: {
                                            unit: 'hour',
                                            displayFormats: {
                                                hour: 'HH:mm'
                                            }
                                        }
                                    }]
                            },
                            animation : false
                        }
                    });

                });
            }

            var refreshId = setInterval(function () {
                update()
            }, 10000);


        </script>
    </body>
</html>
